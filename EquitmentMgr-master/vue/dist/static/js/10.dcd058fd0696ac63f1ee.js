webpackJsonp([10],{rT07:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:function(){return{list:[],listLoading:!1,dialogStatus:"create",dialogFormVisible:!1,tempDef:{defID:"",defType:"",defName:""},filters:this.$store.getters.defType.map(function(e){return e.text=e.defName,e.value=e.defID,e})}},created:function(){this.getDefs()},methods:{getDefs:function(){var e=this;this.listLoading=!0,this.api({url:"/defs/list",method:"get"}).then(function(t){console.log(t),e.list=t.list,e.listLoading=!1})},showUpdate:function(e){this.tempDef.defID=e.row.defID,this.tempDef.defType=e.row.defType,this.tempDef.defName=e.row.defName,this.dialogStatus="update",this.dialogFormVisible=!0},showCreate:function(){this.tempDef.defID="",this.tempDef.defType=-1,this.tempDef.defName="",this.dialogStatus="create",this.dialogFormVisible=!0},createDef:function(){var e=this;this.api({url:"/defs/add",method:"get",params:this.tempDef}).then(function(t){e.$message.success("创建成功"),e.dialogFormVisible=!1,e.getDefs(),e.$store.dispatch("GetDefs")})},updateDef:function(e){var t=this;this.api({url:"/defs/update",method:"get",params:this.tempDef}).then(function(e){t.devStatusLoading=!1,t.dialogFormVisible=!1;var i=t.list.findIndex(function(e){return e.defID==t.tempDef.devID});i>=0&&(t.list[i].defType=t.tempDef.devType.defName,t.list[i].defName=t.tempDef.devType.defID)})},getAppropriateDefID:function(e){var t=this;this.api({url:"/defs/appropriateID",method:"get",params:{defTypeID:e}}).then(function(e){console.log(e),0!=e?t.tempDef.defID=e:t.$message.warning("出现问题,请联系管理员")})},filterMethod:function(e,t,i){var a=i.property;return console.log("property",a),t[a]===e},timeFormatter2:function(e,t,i,a){return Time2GMT8(i)}}},l=i("XyMi"),s=Object(l.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",[i("el-form-item",[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"device:add",expression:"'device:add'"}],attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.showCreate()}}},[e._v("添加 ")])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{staticStyle:{width:"20%"},attrs:{align:"center",label:"定义编号",prop:"defID"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"定义类型",prop:"defType",filters:e.filters,"filter-method":e.filterMethod}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"定义名称",prop:"defName"}}),e._v(" "),e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"定义",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"300px","margin-left":"50px"},attrs:{model:e.tempDef,"label-position":"left","label-width":"80px"}},[i("el-form-item",{attrs:{label:"定义类型",required:""}},[i("el-select",{attrs:{placeholder:"请选择","value-key":"defID"},on:{change:function(t){return e.getAppropriateDefID(e.tempDef.defType)}},model:{value:e.tempDef.defType,callback:function(t){e.$set(e.tempDef,"defType",t)},expression:"tempDef.defType"}},e._l(e.$store.getters.defType,function(e){return i("el-option",{key:e.defID,attrs:{label:e.defName,value:e.defID}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"定义编号",required:"",placeholder:"请输入"}},[i("el-input",{attrs:{type:"text",disabled:""},model:{value:e.tempDef.defID,callback:function(t){e.$set(e.tempDef,"defID",t)},expression:"tempDef.defID"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"定义名称",required:""}},[i("el-input",{attrs:{type:"text"},model:{value:e.tempDef.defName,callback:function(t){e.$set(e.tempDef,"defName",t)},expression:"tempDef.defName"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"===e.dialogStatus?i("el-button",{attrs:{type:"success"},on:{click:e.createDef}},[e._v("创 建")]):i("el-button",{attrs:{type:"primary"},on:{click:e.updateDef}},[e._v("修 改")])],1)],1)],1)},[],!1,null,null,null);t.default=s.exports}});