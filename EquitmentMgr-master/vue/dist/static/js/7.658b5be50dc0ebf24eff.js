webpackJsonp([7],{"+H8G":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("JQQh"),i=a("jBdW"),n=a("zL8q"),o={extends:n.Select,name:"BaseSelect2",data:function(){return{list:[]}},props:{initUrl:String,mKey:String,mLabel:String},created:function(){this.getData()},methods:{getData:function(){var e=this;console.log("BaseSelect2  Get Data"),this.isLoading=!0,this.api({url:this.initUrl,method:"get"}).then(function(t){console.log("baseSelect2 Ret Data:",t),console.log(e.mKey,e.mLabel),e.mKey&&e.mLabel?e.list=t.list.map(function(t){return t.key=t[e.mKey],t.label=t[e.mLabel],t}):e.list=t.list,e.isLoading=!1})}}},r=a("XyMi"),s=Object(r.a)(o,void 0,void 0,!1,null,null,null).exports;s.install=function(e){e.component(s.name,BaseSleect2)};var c=s,m=(a("VsUZ"),{components:{DevTypeSelect:l.a,DevStatusSelect:i.a,BaseSelect2:c},data:function(){return{isAddNote:!1,formData:{eventStage:{},eventType:{},eventTime:"",relative:[]},devList:[],partList:[]}},created:function(){this.queryDevList(),this.queryPartList()},methods:{queryDevList:function(){var e=this;this.api({url:"/dev/query",method:"get",param:this.param?this.param:{}}).then(function(t){console.log("queryDevList",t),e.devList=t.list})},queryPartList:function(){var e=this;this.api({url:"/part/query",method:"get",param:this.param?this.param:{}}).then(function(t){console.log("queryPartList",t),e.partList=t.list})},btn_addRelative_click:function(){this.formData.relative.push({})},removeRelativeByIndex:function(e){this.formData.relative.splice(e,1)},onSubmit:function(){var e=this;this.formData.eventTypeID=this.formData.eventType.defID,this.formData.eventStageID=this.formData.eventStage.defID,this.formData.relative.map(function(e){e.dev&&(e.devID=e.dev.devID),e.part&&(e.partID=e.part.partID)}),console.log("onsubmit",this.formData),this.api({header:{"Content-Type":"application/json;charset=utf-8"},url:"/event/add",method:"post",data:this.formData}).then(function(t){e.$message.success("添加成功")})}}}),v=Object(r.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",[a("el-form-item",{attrs:{label:"事件阶段"}},[a("el-select",{attrs:{"value-key":"defID"},model:{value:e.formData.eventStage,callback:function(t){e.$set(e.formData,"eventStage",t)},expression:"formData.eventStage"}},e._l(e.$store.getters.eventStage,function(e){return a("el-option",{key:e.defID,attrs:{label:e.defName,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"事件类型"}},[a("el-select",{attrs:{"value-key":"defID",filterable:""},model:{value:e.formData.eventType,callback:function(t){e.$set(e.formData,"eventType",t)},expression:"formData.eventType"}},e._l(e.$store.getters.eventType,function(e){return a("el-option",{key:e.defID,attrs:{label:e.defName,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"事件时间"}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.formData.eventTime,callback:function(t){e.$set(e.formData,"eventTime",t)},expression:"formData.eventTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"事件详情"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:20}},model:{value:e.formData.eventDetail,callback:function(t){e.$set(e.formData,"eventDetail",t)},expression:"formData.eventDetail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"事件备注"}},[a("el-switch",{attrs:{label:"是否添加备注"},model:{value:e.isAddNote,callback:function(t){e.isAddNote=t},expression:"isAddNote"}}),e._v(" "),e.isAddNote?a("el-input",{staticClass:"eventNote",attrs:{type:"textarea",autosize:{minRows:2,maxRows:20}},model:{value:e.formData.eventNote,callback:function(t){e.$set(e.formData,"eventNote",t)},expression:"formData.eventNote"}}):e._e()],1),e._v(" "),a("el-form-item",[a("el-tooltip",{attrs:{content:"添加相关设备配件"}},[a("el-button",{attrs:{icon:"el-icon-circle-plus"},on:{click:e.btn_addRelative_click}})],1)],1),e._v(" "),e._l(e.formData.relative,function(t,l){return a("el-form-item",{key:l},[a("span",[e._v(e._s("设备-"+l))]),e._v(" "),a("el-select",{attrs:{"value-key":"devID",filterable:""},model:{value:e.formData.relative[l].dev,callback:function(t){e.$set(e.formData.relative[l],"dev",t)},expression:"formData.relative[index].dev"}},e._l(e.devList,function(e){return a("el-option",{key:e.devID,attrs:{label:e.devID,value:e}})}),1),e._v(" "),a("span",[e._v(e._s("配件-"+l))]),e._v(" "),a("el-select",{attrs:{"value-key":"partID",filterable:""},model:{value:e.formData.relative[l].part,callback:function(t){e.$set(e.formData.relative[l],"part",t)},expression:"formData.relative[index].part"}},e._l(e.partList,function(t){return a("el-option",{key:t.partID,attrs:{label:t.partType,value:t}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.partType))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.partID))])])}),1),e._v(" "),a("el-button",{staticClass:"el-icon-delete",on:{click:function(t){return e.removeRelativeByIndex(l)}}})],1)}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],2)],1)},[],!1,null,null,null);t.default=v.exports}});