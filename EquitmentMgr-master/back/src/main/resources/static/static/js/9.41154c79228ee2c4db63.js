webpackJsonp([9],{tWNf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("0xDb"),s=i("sNv2"),l=i("JQQh"),o=i("jBdW"),r={components:{BaseSelect:s.a,DevTypeSelect:l.a,DevStatusSelect:o.a},data:function(){return{totalCount:0,list:[],listLoading:!1,listQuery:{pageNum:1,pageRow:50},dialogStatus:"create",dialogFormVisible:!1,tempDev:{devID:"",devType:{defID:0,defName:""},devStatus:{defID:0,defName:""}}}},created:function(){this.getDevices()},methods:{getDevices:function(){var e=this;this.listLoading=!0,this.api({url:"/dev/list",method:"get",params:this.listQuery}).then(function(t){console.log(t),e.list=t.list,e.listLoading=!1,e.totalCount=t.totalCount})},handleSizeChange:function(e){this.listQuery.pageRow=e,this.handleFilter()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getDevices()},handleFilter:function(){this.listQuery.pageNum=1,this.getDevices()},showParts:function(e){console.log("showParts"),console.log(e),this.$router.push({path:"/device/devParts",query:{devID:e.devID}})},showUpdate:function(e){this.tempDev.devID=e.row.devID,this.tempDev.devType.defID=e.row.devTypeID,this.tempDev.devType.defName=e.row.devType,this.tempDev.devStatus.defID=e.row.devStatusID,this.tempDev.devStatus.defName=e.row.devStatus,this.dialogStatus="update",this.dialogFormVisible=!0},showCreate:function(){this.tempDev.devID="",this.tempDev.devType.defID=-1,this.tempDev.devType.defName="",this.tempDev.devStatus.defID=-1,this.tempDev.devStatus.defName="",this.dialogStatus="create",this.dialogFormVisible=!0},createDev:function(){var e=this;this.api({url:"/dev/add",method:"get",params:{devID:this.tempDev.devID,devTypeID:this.tempDev.devType.defID,devStatusID:this.tempDev.devStatus.defID}}).then(function(t){e.$message.success("创建成功"),e.dialogFormVisible=!1,e.getDevices()})},updateDev:function(e){var t=this;this.api({url:"/dev/update",method:"get",params:{devID:this.tempDev.devID,devTypeID:this.tempDev.devType.defID,devStatusID:this.tempDev.devStatus.defID}}).then(function(e){t.devStatusLoading=!1,t.dialogFormVisible=!1;var i=t.list.findIndex(function(e){return e.devID==t.tempDev.devID});i>=0&&(t.list[i].devType=t.tempDev.devType.defName,t.list[i].devTypeID=t.tempDev.devType.defID,t.list[i].devStatus=t.tempDev.devStatus.defName,t.list[i].devStatusID=t.tempDev.devStatus.defID)})},timeFormatter2:function(e,t,i,s){return Object(a.a)(i)}}},d=i("XyMi"),n=Object(d.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",[i("el-form-item",[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"device:add",expression:"'device:add'"}],attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.showCreate()}}},[e._v("添加 ")])],1)],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,border:"",fit:"","highlight-current-row":""},on:{"row-dblclick":e.showParts}},[i("el-table-column",{staticStyle:{width:"20%"},attrs:{align:"center",label:"设备编号",prop:"devID"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"设备类型",prop:"devType"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"设备状态",prop:"devStatus"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"设备创建时间",prop:"createTime",formatter:e.timeFormatter2}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"管理",width:"140",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"device:update",expression:"'device:update'"}],attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(i){return e.showUpdate(t)}}}),e._v(" "),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"device:delete",expression:"'device:delete'"}],attrs:{type:"danger",icon:"el-icon-delete",size:"mini"}})]}}])})],1),e._v(" "),i("el-pagination",{attrs:{"current-page":e.listQuery.pageNum,"page-size":e.listQuery.pageRow,total:e.totalCount,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("el-dialog",{attrs:{title:"设备",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"300px","margin-left":"50px"},attrs:{model:e.tempDev,"label-position":"left","label-width":"80px"}},[i("el-form-item",{attrs:{label:"设备编号",required:"",placeholder:"请输入"}},[i("el-input",{attrs:{type:"text"},model:{value:e.tempDev.devID,callback:function(t){e.$set(e.tempDev,"devID",t)},expression:"tempDev.devID"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备类型",required:""}},[i("el-select",{attrs:{placeholder:"请选择","value-key":"defID"},model:{value:e.tempDev.devType,callback:function(t){e.$set(e.tempDev,"devType",t)},expression:"tempDev.devType"}},e._l(e.$store.getters.devType,function(e){return i("el-option",{key:e.defID,attrs:{label:e.defName,value:e}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"设备状态",required:""}},[i("el-select",{attrs:{placeholder:"请选择","value-key":"defID"},model:{value:e.tempDev.devStatus,callback:function(t){e.$set(e.tempDev,"devStatus",t)},expression:"tempDev.devStatus"}},e._l(e.$store.getters.devStatus,function(e){return i("el-option",{key:e.defID,attrs:{label:e.defName,value:e}})}),1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"create"===e.dialogStatus?i("el-button",{attrs:{type:"success"},on:{click:e.createDev}},[e._v("创 建")]):i("el-button",{attrs:{type:"primary"},on:{click:e.updateDev}},[e._v("修 改")])],1)],1)],1)},[],!1,null,null,null);t.default=n.exports}});